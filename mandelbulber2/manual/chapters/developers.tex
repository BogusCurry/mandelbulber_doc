\section{Developer information}\label{developers}\index{Developer Information}

The Mandelbulber team welcomes everyone who likes to help us with the development of the software.
Whether you are a C++ fan and want to implement new features or you like to tweak the fractal formulas.
The code base is well structured and can be compiled with most common compilers and operation systems.
No magic involved, you just need to learn the tools and utilities to modify and run your own version of Mandelbulber.

The following chapters will help you get ready for development.

\subsection{Setup}\label{developers-setup}
\subsubsection{Setup Debian/Ubuntu}\label{developers-setup-debian-and-ubuntu}

TODO

\subsubsection{Setup Windows}\label{developers-setup-windows}

TODO

\subsection{Building}\label{developers-building}
\subsubsection{Building with qtcreator}\label{developers-building-qtcreator}

Compilation in QtCreator

\begin{itemize}
	\item open [PROJECT\_PATH]/mandelbulber2/qmake folder in File Manager
	\item open mandelbulber.pro in Qt Creator
	\item when it's open, click Configure Project
	\item unfold Compiler Messages window (on the bottom of window)
	\item click hammer icon (build - left/bottom corner)
	   the program will be compiled. If you did all steps correctly, shouldn't be error here
	\item try to run the program using green arrow
\end{itemize}

\subsection{Writing own formulas in Mandelbulber}\label{developers-writing-own-formulas}
\subsubsection{Writing formula code}\label{developers-writing-formula-code}

Adding new formulas:

- fractal\_list.hpp:45 - \emph{enum enumFractalFormula} - here is the list of formulas. Add new formula at the end with unique number.

- fractal\_list.cpp:41 - \emph{void DefineFractalList(QList<sFractalDescription> *fractalList)} - here is detailed list of formulas

example:
\begin{lstlisting}
fractalList->append(sFractalDescription("Kaleidoscopic IFS", "kaleidoscopic_ifs",
		kaleidoscopicIfs, KaleidoscopicIfsIteration, analyticDEType, linearDEFunction,
		cpixelDisabledByDefault, 100, analyticFunctionIFS, coloringFunctionIFS));
\end{lstlisting}

\begin{itemize}
	\item 1st parameter: Displayed name of the fractal
	\item 2nd parameter: internal name of the fractal. The same name is used for UI files
	\item 3rd parameter: the same name as in enumFractalFormula
	\item 4th parameter: The function name as defined in fractal\_formulas.cpp
	\item 5th parameter: type of distance estimation. Most of formulas use deltaDE estimation which needs more computation
		but doesn't need any special code from you.
	\item 6th parameter: TODO
	\item 7th parameter: TODO
	\item 8th parameter: TODO
	\item 9th parameter: TODO
	\item 10th parameter: TODO
\end{itemize}

- fractal\_formulas.cpp - here are definitions of function which calculate single fractal iteration. There is no adding of C constant and bailout condition here.

example:
\lstinputlisting[caption={Formula > Mandelbulb formula}]{code/formula_mandelbulb_with_function.cpp}

TODO check copied content of this subsubsection from here on...

arguments:
z - input / output variable containing iteration vector
const cFractal *fractal - read only container with all fractal parameters
sMandelbulbAux \&aux - input / output auxiliary structure containing values needed for instant to calculate estimated distance

All parameters and data structures are defined in fractal.h

- fractal\_formulas.hpp - here are declaration of functions

- compute\_fractal.cpp:42 - void Compute(const cFourFractals \&four, const sFractalIn \&in, sFractalOut *out) - here is the main iteration loop. You need to add in line about 290 calling of your new function.
  In line 305 you can do some exceptions for adding C constant

		TODO

  In line 344 there are bailout conditions. Now all formulas use the same condition. You you need to create any special escape condition then just tell me.

TODO

- initparameters.cpp:389 - void InitFractalParams(cParameterContainer *par) - here are definition of names of parameters which are used in UI and settings files. If you add new formula then try to utilize existing names. If there is nothing which fits to your needs, then add new one

- fractal.cpp, fractal.hpp - here are data structures for fractal parameters. There is also copying of values from internal parameter representation to data structures which you use in fractal functions

\subsubsection{Designing user interface}\label{developers-designing-user-interface}

To create UI files you can use Qt Designer application. The best would be if you make them based on existing files. All ui files are located in formula/ui folder. Names start with fractal\_ and the rest of name is the same as internal fractal name. Even if formula doesn't use any parameters, you need to create UI file which is the same like fractal\_quaternion.ui (some kind of dummy).

In UI files there are very important important names of edit fields. The program connects automatically edit fields with adequate parameters and connects edit fields with sliders/knobs. But to make it working first part of the name must describe type of edit widget. Use following prefixes:
\begin{itemize}
	\item spinbox\_ - scalar value
	\item slider\_ - slider for scalar value
	\item checkBox\_ - boolean value
	\item spinboxd3\_ - edit field for knob for angle. This is for 3 dimensions, 
		where angles are stored in CVector3 data type. Last letter of name must indicate axis name (\_x, \_y, \_z)
	\item dial3 - knob for spinboxd3
	\item spinboxInt - spinbox for integer value
	\item sliderInt - slider for spinboxInt
	\item logedit - edit field for high variation value (only positive)
	\item logslider - slider for logedit which changes value in logarithmic scale
	\item vect3 - 3d vector (related to CVector3 data type). Name must ends with axis name
\end{itemize}

Rest of the name of edit field must be the same as defined in initparameters.cpp
